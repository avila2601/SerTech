import{a as _}from"./chunk-GEZ4QFCU.js";import"./chunk-JQZRJRG7.js";import{a as I}from"./chunk-A5FDEGXE.js";import{b as E}from"./chunk-7L3OMWMM.js";import"./chunk-4V4BOX2V.js";import{a as S}from"./chunk-C7K2NY2G.js";import"./chunk-6FGELC55.js";import{b as x,d as C}from"./chunk-R254MLMK.js";import"./chunk-O6PKEHSA.js";import"./chunk-BYXBJQAS.js";import{Ba as h,Fa as g,H as p,La as d,Na as o,Oa as e,Ta as u,Ua as f,Ya as t,_a as a,ta as r,wb as b,xa as m,yb as v}from"./chunk-QVS6JBII.js";function y(s,i){if(s&1&&(o(0,"div",1)(1,"h3"),t(2,"Informaci\xF3n del T\xE9cnico"),e(),o(3,"p")(4,"strong"),t(5,"Nombre:"),e(),t(6),e(),o(7,"p")(8,"strong"),t(9,"Especialidad:"),e(),t(10),e()()),s&2){let c=f();r(6),a(" ",c.tecnico.nombre,""),r(4),a(" ",c.tecnico.especialidad,"")}}function M(s,i){s&1&&(o(0,"span"),t(1,"Agendar Cita"),e())}function O(s,i){s&1&&(o(0,"span"),t(1,"Agendando..."),e())}var P=class s{constructor(i,c,n,l,T,R){this.route=i;this.router=c;this.citaService=n;this.clienteService=l;this.tecnicoService=T;this.appComponent=R}marca="";producto="";modelo="";sintomas="";ubicacion="";fecha="";hora="";nombre="";email="";telefono="";direccion="";isAgendando=!1;tecnicoId="";servicioId="";tecnico=null;ngOnInit(){this.route.queryParams.subscribe(i=>{this.marca=i.marca||"",this.producto=i.producto||"",this.modelo=i.modelo||"",this.sintomas=i.sintomas||"",this.ubicacion=i.ubicacion||"",this.fecha=i.fecha||"",this.hora=i.hora||"",this.nombre=i.nombre||"",this.email=i.email||"",this.telefono=i.telefono||"",this.direccion=i.direccion||"",this.tecnicoId=i.tecnicoId||"",this.servicioId=i.servicioId||"",this.tecnicoId&&this.cargarInformacionTecnico()})}cargarInformacionTecnico(){this.tecnicoService.getTecnicoById(this.tecnicoId).subscribe(i=>{this.tecnico=i||null})}regresar(){this.router.navigate(["/clientes"],{queryParams:{marca:this.marca,producto:this.producto,modelo:this.modelo,sintomas:this.sintomas,ubicacion:this.ubicacion,fecha:this.fecha,hora:this.hora,nombre:this.nombre,email:this.email,telefono:this.telefono,direccion:this.direccion}})}agendarCita(){if(!this.nombre||!this.email||!this.telefono||!this.direccion){alert("Por favor completa todos los campos requeridos");return}this.isAgendando=!0,this.clienteService.getClientes().pipe(p(i=>{let c=i.find(n=>n.email===this.email);if(c)return[c];{let n={nombre:this.nombre,email:this.email,telefono:this.telefono,direccion:this.direccion};return this.clienteService.agregarCliente(n)}}),p(i=>{let c={marca:this.marca,producto:this.producto,modelo:this.modelo,sintomas:this.sintomas,ubicacion:this.ubicacion},n;this.fecha?n=new Date(this.fecha+"T00:00:00"):n=new Date;let l={clienteId:i.id,tecnicoId:this.tecnicoId,servicioId:this.servicioId,fecha:n,hora:this.hora||"Por coordinar",notas:JSON.stringify(c),direccion:this.direccion};return this.citaService.crearCita(l)})).subscribe(i=>{this.isAgendando=!1,localStorage.setItem("clienteLogueado",i.clienteId),this.appComponent.actualizarEstadoUsuario(),alert("\xA1Cita agendada exitosamente!"),this.router.navigate(["/mis-citas"],{queryParams:{clienteId:i.clienteId}})})}static \u0275fac=function(c){return new(c||s)(m(x),m(C),m(I),m(S),m(E),m(_))};static \u0275cmp=h({type:s,selectors:[["app-resumen-cita"]],decls:66,vars:15,consts:[[1,"resumen-cita-container"],[1,"resumen-section"],["class","resumen-section",4,"ngIf"],[1,"resumen-actions"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click","disabled"],[4,"ngIf"]],template:function(c,n){c&1&&(o(0,"div",0)(1,"h2"),t(2,"Resumen de tu cita"),e(),o(3,"div",1)(4,"h3"),t(5,"Datos del Servicio"),e(),o(6,"p")(7,"strong"),t(8,"Marca:"),e(),t(9),e(),o(10,"p")(11,"strong"),t(12,"Producto:"),e(),t(13),e(),o(14,"p")(15,"strong"),t(16,"Modelo:"),e(),t(17),e(),o(18,"p")(19,"strong"),t(20,"S\xEDntomas:"),e(),t(21),e(),o(22,"p")(23,"strong"),t(24,"Ubicaci\xF3n:"),e(),t(25),e(),o(26,"p")(27,"strong"),t(28,"Fecha:"),e(),t(29),e(),o(30,"p")(31,"strong"),t(32,"Hora:"),e(),t(33),e()(),g(34,y,11,2,"div",2),o(35,"div",1)(36,"h3"),t(37,"Datos Personales"),e(),o(38,"p")(39,"strong"),t(40,"Nombre:"),e(),t(41),e(),o(42,"p")(43,"strong"),t(44,"Email:"),e(),t(45),e(),o(46,"p")(47,"strong"),t(48,"Tel\xE9fono:"),e(),t(49),e(),o(50,"p")(51,"strong"),t(52,"Direcci\xF3n:"),e(),t(53),e()(),o(54,"div",1)(55,"h3"),t(56,"Costo del servicio"),e(),o(57,"p")(58,"strong"),t(59,"Valor:"),e()()(),o(60,"div",3)(61,"button",4),u("click",function(){return n.regresar()}),t(62,"Regresar"),e(),o(63,"button",5),u("click",function(){return n.agendarCita()}),g(64,M,2,0,"span",6)(65,O,2,0,"span",6),e()()()),c&2&&(r(9),a(" ",n.marca,""),r(4),a(" ",n.producto,""),r(4),a(" ",n.modelo,""),r(4),a(" ",n.sintomas,""),r(4),a(" ",n.ubicacion,""),r(4),a(" ",n.fecha||"Por coordinar",""),r(4),a(" ",n.hora||"Por coordinar",""),r(),d("ngIf",n.tecnico),r(7),a(" ",n.nombre,""),r(4),a(" ",n.email,""),r(4),a(" ",n.telefono,""),r(4),a(" ",n.direccion,""),r(10),d("disabled",n.isAgendando),r(),d("ngIf",!n.isAgendando),r(),d("ngIf",n.isAgendando))},dependencies:[v,b],styles:[".resumen-cita-container[_ngcontent-%COMP%]{max-width:500px;margin:2rem auto;background:#1e293bf2;border-radius:16px;box-shadow:0 4px 24px #0003;padding:2rem;color:#fff}.resumen-section[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid rgba(255,255,255,.08)}.resumen-section[_ngcontent-%COMP%]:last-child{border-bottom:none}.resumen-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.7rem;color:#a5b4fc;font-size:1.1rem}.resumen-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.2rem 0;font-size:1rem}.resumen-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;margin-top:2rem}.btn[_ngcontent-%COMP%]{min-width:120px;padding:.75rem 1.5rem;font-size:1rem;border:none;border-radius:8px;cursor:pointer;transition:all .3s ease;font-weight:600}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6b7280,#4b5563);color:#fff;box-shadow:0 4px 15px #6b72804d}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#5a6fd8,#6a4190);transform:translateY(-2px);box-shadow:0 6px 20px #6b728066}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 4px 15px #667eea4d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#5a6fd8,#6a4190);transform:translateY(-2px);box-shadow:0 6px 20px #667eea66}.disponible[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.no-disponible[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}"]})};export{P as ResumenCitaComponent};
